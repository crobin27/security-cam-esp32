# ESP32 Firmware for Security Camera

This directory contains the firmware code for the ESP32-CAM module, which serves as the heart of the Security Cam ESP32 project. The ESP32 firmware is responsible for capturing images, establishing secure communication with AWS IoT Core, and uploading images to an S3 bucket via pre-signed URLs.

## Overview

The ESP32-CAM firmware is written in C and configured to handle various functionalities, including image capture, Wi-Fi connectivity, and secure cloud communication. It leverages the ESP-IDF framework to interact with the hardware and provides seamless integration with the backend cloud services.

### Features

- **Image Capture**: Captures high-quality JPEG images using the ESP32-CAM module.
- **AWS IoT Integration**: Uses MQTT protocols to connect to AWS IoT Core securely.
- **Pre-Signed URL Uploads**: Uploads images directly to AWS S3 using pre-signed URLs generated by backend Lambda functions.
- **Wi-Fi Management**: Connects to the local Wi-Fi network, with retry logic for robustness.
- **Configurable Parameters**: Allows flexibility in settings such as MQTT topics, Wi-Fi credentials, and cloud endpoint URLs.

## Key Files

- **`main.c`**:
  - The entry point of the firmware, initializing all subsystems (camera, Wi-Fi, MQTT).
  - Orchestrates the process of image capture and upload.
- **`camera.c` / `camera.h`**:
  - Handles the ESP32-CAM’s camera initialization and image capture logic.
- **`wifi_connect.c` / `wifi_connect.h`**:
  - Manages Wi-Fi connection setup and reconnection logic.
- **`aws_iot.c` / `aws_iot.h`**:
  - Implements MQTT communication with AWS IoT Core.
  - Publishes device status and triggers the Lambda workflow for pre-signed URLs.
- **`aws_upload.c`**:
  - Handles the HTTP POST requests for uploading images to S3 using pre-signed URLs.

## Firmware Workflow

1. **Device Initialization**:
   - The ESP32 initializes its peripherals (camera, Wi-Fi, and MQTT).
   - Attempts to connect to the configured Wi-Fi network.
2. **AWS IoT Connection**:
   - Establishes an MQTT connection with AWS IoT Core.
   - Publishes a "ready" status to notify the cloud that the device is online.
3. **Image Capture**:
   - The device triggers its camera module to capture an image in JPEG format.
4. **Image Upload**:
   - Requests a pre-signed URL from AWS Lambda via MQTT.
   - Uses the pre-signed URL to upload the captured image to S3.
5. **Error Handling**:
   - Implements retry logic for Wi-Fi and MQTT failures.
   - Logs errors to assist with debugging.

## Skills Demonstrated

- **Embedded Development**: Wrote firmware using ESP-IDF to manage hardware components and cloud communication.
- **Networking**:
  - Configured MQTT for secure communication with AWS IoT Core.
  - Implemented HTTPS uploads to S3 using pre-signed URLs.
- **IoT Architecture**: Designed the firmware to integrate with a cloud-based backend for scalable image management.
- **Error Handling and Debugging**: Built robust error-handling mechanisms for network and hardware issues.

## Challenges Overcome

- **Memory Management**: Optimized memory usage to handle large image buffers in the constrained environment of the ESP32.
- **Secure Communication**: Implemented TLS for MQTT and HTTPS requests to ensure data privacy.
- **Hardware Limitations**: Accounted for the ESP32-CAM’s limited computational power and memory, designing an efficient workflow to capture and upload images.

## Future Enhancements

- Add OTA (Over-The-Air) update functionality for remote firmware updates.
- Incorporate motion detection to trigger image capture and uploads dynamically.
- Optimize image capture settings for better quality in varying lighting conditions.

## Hardware Requirements

- **ESP32-CAM Module**: The main microcontroller with camera functionality.
- **Wi-Fi Network**: For cloud communication.
- **AWS Account**: Configured with IoT Core, Lambda, and S3 for integration.

## Why This Section?

The ESP32 firmware demonstrates my ability to program and optimize embedded systems for real-world IoT applications. By integrating hardware with cloud services, this section showcases a complete end-to-end solution for image capture and management.

---

This section is a critical component of the Security Cam ESP32 project and highlights my skills in embedded systems development and IoT integration.
